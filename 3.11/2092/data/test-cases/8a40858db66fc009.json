{"uid":"8a40858db66fc009","name":"Validate Council Output [SalfordCityCouncil]","fullName":"features/validate_council_outputs.feature:Validate Council Output","historyId":"46bdc81110002bd93542f111d9af2812","time":{"start":1725668411416,"stop":1725668414098,"duration":2682},"status":"failed","statusMessage":"AttributeError: 'NoneType' object has no attribute 'find_all'","statusTrace":"fixturefunc = <function scrape_step at 0x7f26995c6d40>\nrequest = <FixtureRequest for <Function test_scenario_outline[SalfordCityCouncil]>>\nkwargs = {'context': <test_validate_council.Context object at 0x7f2699446710>, 'headless_mode': 'True', 'local_browser': 'False', 'selenium_url': 'http://localhost:4444'}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n../../../.cache/pypoetry/virtualenvs/uk-bin-collection-EwS6Gn8s-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:897: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nuk_bin_collection/tests/step_defs/test_validate_council.py:100: in scrape_step\n    context.parse_result = CollectData.run()\nuk_bin_collection/uk_bin_collection/collect_data.py:101: in run\n    return self.client_code(\nuk_bin_collection/uk_bin_collection/collect_data.py:121: in client_code\n    return get_bin_data_class.template_method(address_url, **kwargs)\nuk_bin_collection/uk_bin_collection/get_bin_data.py:61: in template_method\n    bin_data_dict = self.get_and_parse_data(this_url, **kwargs)\nuk_bin_collection/uk_bin_collection/get_bin_data.py:84: in get_and_parse_data\n    bin_data_dict = self.parse_data(\"\", url=address_url, **kwargs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <SalfordCityCouncil.CouncilClass object at 0x7f2699262c50>, page = ''\nkwargs = {'council_module_str': 'SalfordCityCouncil', 'dev_mode': False, 'headless': True, 'local_browser': False, ...}\napi_url = 'https://www.salford.gov.uk/bins-and-recycling/bin-collection-days/your-bin-collections'\nuser_uprn = '100011416709', params = {'UPRN': '100011416709'}\nresponse = <Response [200]>\nsoup = \n<!DOCTYPE html>\n\n<html class=\"nojs\" lang=\"en\">\n<head>\n<meta charset=\"utf-8\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-U... src=\"https://v4in1-si.click4assistance.co.uk/SI.js\" type=\"text/javascript\"></script>\n<!-- V13.2.2 -->\n</body>\n</html>\n\ndata = {'bins': []}, div_element = None\n\n    def parse_data(self, page: str, **kwargs) -> dict:\n        api_url = \"https://www.salford.gov.uk/bins-and-recycling/bin-collection-days/your-bin-collections\"\n        user_uprn = kwargs.get(\"uprn\")\n    \n        # Check the UPRN is valid\n        check_uprn(user_uprn)\n    \n        # Create the form data\n        params = {\n            \"UPRN\": user_uprn,\n        }\n    \n        # Make a request to the API\n        requests.packages.urllib3.disable_warnings()\n        response = requests.get(api_url, params=params)\n    \n        # Make a BS4 object\n        soup = BeautifulSoup(response.text, features=\"html.parser\")\n        soup.prettify()\n    \n        data = {\"bins\": []}\n    \n        # Get the div element\n        div_element = soup.find(\"div\", {\"class\": \"wastefurther\"})\n    \n        # Get the bins\n>       bin_lists = div_element.find_all(\"ul\")\nE       AttributeError: 'NoneType' object has no attribute 'find_all'\n\nuk_bin_collection/uk_bin_collection/councils/SalfordCityCouncil.py:42: AttributeError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"failed","statusMessage":"AttributeError: 'NoneType' object has no attribute 'find_all'","statusTrace":"fixturefunc = <function scrape_step at 0x7f26995c6d40>\nrequest = <FixtureRequest for <Function test_scenario_outline[SalfordCityCouncil]>>\nkwargs = {'context': <test_validate_council.Context object at 0x7f2699446710>, 'headless_mode': 'True', 'local_browser': 'False', 'selenium_url': 'http://localhost:4444'}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n../../../.cache/pypoetry/virtualenvs/uk-bin-collection-EwS6Gn8s-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:897: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nuk_bin_collection/tests/step_defs/test_validate_council.py:100: in scrape_step\n    context.parse_result = CollectData.run()\nuk_bin_collection/uk_bin_collection/collect_data.py:101: in run\n    return self.client_code(\nuk_bin_collection/uk_bin_collection/collect_data.py:121: in client_code\n    return get_bin_data_class.template_method(address_url, **kwargs)\nuk_bin_collection/uk_bin_collection/get_bin_data.py:61: in template_method\n    bin_data_dict = self.get_and_parse_data(this_url, **kwargs)\nuk_bin_collection/uk_bin_collection/get_bin_data.py:84: in get_and_parse_data\n    bin_data_dict = self.parse_data(\"\", url=address_url, **kwargs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <SalfordCityCouncil.CouncilClass object at 0x7f2699262c50>, page = ''\nkwargs = {'council_module_str': 'SalfordCityCouncil', 'dev_mode': False, 'headless': True, 'local_browser': False, ...}\napi_url = 'https://www.salford.gov.uk/bins-and-recycling/bin-collection-days/your-bin-collections'\nuser_uprn = '100011416709', params = {'UPRN': '100011416709'}\nresponse = <Response [200]>\nsoup = \n<!DOCTYPE html>\n\n<html class=\"nojs\" lang=\"en\">\n<head>\n<meta charset=\"utf-8\"/>\n<meta content=\"IE=edge\" http-equiv=\"X-U... src=\"https://v4in1-si.click4assistance.co.uk/SI.js\" type=\"text/javascript\"></script>\n<!-- V13.2.2 -->\n</body>\n</html>\n\ndata = {'bins': []}, div_element = None\n\n    def parse_data(self, page: str, **kwargs) -> dict:\n        api_url = \"https://www.salford.gov.uk/bins-and-recycling/bin-collection-days/your-bin-collections\"\n        user_uprn = kwargs.get(\"uprn\")\n    \n        # Check the UPRN is valid\n        check_uprn(user_uprn)\n    \n        # Create the form data\n        params = {\n            \"UPRN\": user_uprn,\n        }\n    \n        # Make a request to the API\n        requests.packages.urllib3.disable_warnings()\n        response = requests.get(api_url, params=params)\n    \n        # Make a BS4 object\n        soup = BeautifulSoup(response.text, features=\"html.parser\")\n        soup.prettify()\n    \n        data = {\"bins\": []}\n    \n        # Get the div element\n        div_element = soup.find(\"div\", {\"class\": \"wastefurther\"})\n    \n        # Get the bins\n>       bin_lists = div_element.find_all(\"ul\")\nE       AttributeError: 'NoneType' object has no attribute 'find_all'\n\nuk_bin_collection/uk_bin_collection/councils/SalfordCityCouncil.py:42: AttributeError","steps":[{"name":"Given the council","time":{"start":1725668411416,"stop":1725668411416,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"When we scrape the data from the council","time":{"start":1725668411416,"stop":1725668414098,"duration":2682},"status":"failed","statusMessage":"'NoneType' object has no attribute 'find_all'","statusTrace":"AttributeError: 'NoneType' object has no attribute 'find_all'\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"c5976e03b46c0503","name":"stdout","source":"c5976e03b46c0503.txt","type":"text/plain","size":45}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":2,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"host","value":"fv-az2021-39"},{"name":"thread","value":"2819-MainThread"},{"name":"framework","value":"pytest-bdd"},{"name":"language","value":"cpython3"},{"name":"feature","value":"Test each council output matches expected results"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"council","value":"SalfordCityCouncil"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":29,"broken":0,"skipped":0,"passed":281,"unknown":0,"total":310},"items":[{"uid":"a24ce55f397efb10","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2088//#testresult/a24ce55f397efb10","status":"passed","time":{"start":1725582307154,"stop":1725582312515,"duration":5361}},{"uid":"7650c3982fc49f8f","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2086//#testresult/7650c3982fc49f8f","status":"passed","time":{"start":1725570126062,"stop":1725570127445,"duration":1383}},{"uid":"ca52c16de060e777","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2083//#testresult/ca52c16de060e777","status":"passed","time":{"start":1725495636082,"stop":1725495639760,"duration":3678}},{"uid":"dc03a398e688eba1","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2082//#testresult/dc03a398e688eba1","status":"passed","time":{"start":1725430991615,"stop":1725430993872,"duration":2257}},{"uid":"1dd1b9fbd8d65ad3","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2082//#testresult/1dd1b9fbd8d65ad3","status":"passed","time":{"start":1725409319399,"stop":1725409321382,"duration":1983}},{"uid":"5ccfd892fb9f1fcf","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2080//#testresult/5ccfd892fb9f1fcf","status":"passed","time":{"start":1725404571033,"stop":1725404573350,"duration":2317}},{"uid":"148bc9132274e507","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2073//#testresult/148bc9132274e507","status":"passed","time":{"start":1725385562143,"stop":1725385565407,"duration":3264}},{"uid":"833e98b2057a1e7e","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2070//#testresult/833e98b2057a1e7e","status":"passed","time":{"start":1725347792565,"stop":1725347802836,"duration":10271}},{"uid":"52e78edd0d4ccbf1","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2069//#testresult/52e78edd0d4ccbf1","status":"passed","time":{"start":1725322783273,"stop":1725322786761,"duration":3488}},{"uid":"848c39e64df15d6c","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2068//#testresult/848c39e64df15d6c","status":"passed","time":{"start":1725317186377,"stop":1725317188218,"duration":1841}},{"uid":"41efe6480571d1a0","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2066//#testresult/41efe6480571d1a0","status":"passed","time":{"start":1725313322284,"stop":1725313326087,"duration":3803}},{"uid":"fb989189813810cb","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2064//#testresult/fb989189813810cb","status":"passed","time":{"start":1725311473565,"stop":1725311476564,"duration":2999}},{"uid":"209e066200d5b383","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2060//#testresult/209e066200d5b383","status":"passed","time":{"start":1725308961042,"stop":1725308962972,"duration":1930}},{"uid":"45448d34509dccb7","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2059//#testresult/45448d34509dccb7","status":"passed","time":{"start":1725308604389,"stop":1725308606057,"duration":1668}},{"uid":"7e9790b602f711ce","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2054//#testresult/7e9790b602f711ce","status":"passed","time":{"start":1725236372116,"stop":1725236373685,"duration":1569}},{"uid":"59cfdd0a30767c21","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2053//#testresult/59cfdd0a30767c21","status":"passed","time":{"start":1725150363305,"stop":1725150364934,"duration":1629}},{"uid":"2061314d12a2cc76","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2052//#testresult/2061314d12a2cc76","status":"passed","time":{"start":1725063676521,"stop":1725063678231,"duration":1710}},{"uid":"995dfdf387104ab7","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2051//#testresult/995dfdf387104ab7","status":"passed","time":{"start":1724977494403,"stop":1724977496322,"duration":1919}},{"uid":"d1afa710b27ce2ce","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2049//#testresult/d1afa710b27ce2ce","status":"passed","time":{"start":1724890780023,"stop":1724890781372,"duration":1349}},{"uid":"6ca9c74be69eb799","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/2048//#testresult/6ca9c74be69eb799","status":"passed","time":{"start":1724804467251,"stop":1724804468671,"duration":1420}}]},"tags":[]},"source":"8a40858db66fc009.json","parameterValues":["SalfordCityCouncil"]}