{"uid":"91962c5d4967cd8c","name":"Validate Council Output [HullCityCouncil-None-None]","fullName":"features/validate_council_outputs.feature:Validate Council Output","historyId":"4c79f337ae0fcd2cb1e638743025dfd3","time":{"start":1715732906012,"stop":1715732911794,"duration":5782},"status":"failed","statusMessage":"ConnectionRefusedError: Cannot connect to API!","statusTrace":"fixturefunc = <function scrape_step at 0x7fefb8b58cc0>\nrequest = <FixtureRequest for <Function test_scenario_outline[HullCityCouncil-None-None]>>\nkwargs = {'context': <test_validate_council.context.<locals>.Context object at 0x7fefb81fc8d0>, 'council': 'HullCityCouncil', 'headless_mode': 'True', 'selenium_mode': 'None', ...}\n\n    def call_fixture_func(\n        fixturefunc: \"_FixtureFunc[FixtureValue]\", request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n../../../.cache/pypoetry/virtualenvs/uk-bin-collection-EwS6Gn8s-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:902: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nuk_bin_collection/tests/step_defs/test_validate_council.py:92: in scrape_step\n    context.parse_result = CollectData.run()\nuk_bin_collection/uk_bin_collection/collect_data.py:102: in run\n    return self.client_code(\nuk_bin_collection/uk_bin_collection/collect_data.py:121: in client_code\n    return get_bin_data_class.template_method(address_url, **kwargs)\nuk_bin_collection/uk_bin_collection/get_bin_data.py:80: in template_method\n    bin_data_dict = self.parse_data(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <HullCityCouncil.CouncilClass object at 0x7fefb7f71e50>, page = ''\nkwargs = {'headless': True, 'paon': None, 'postcode': None, 'uprn': '21033995', ...}\nuser_uprn = '21033995', data = {'bins': []}\nheaders = {'accept': '*/*', 'accept-language': 'en-GB,en;q=0.9', 'authority': 'www.hull.gov.uk', 'cache-control': 'no-cache', ...}\napi_url = 'https://www.hull.gov.uk/ajax/bin-collection?bindate=21033995'\nres = <Response [500]>\n\n    def parse_data(self, page: str, **kwargs) -> dict:\n    \n        user_uprn = kwargs.get(\"uprn\")\n        check_uprn(user_uprn)\n        data = {\"bins\": []}\n    \n        headers = {\n            \"authority\": \"www.hull.gov.uk\",\n            \"accept\": \"*/*\",\n            \"accept-language\": \"en-GB,en;q=0.9\",\n            \"cache-control\": \"no-cache\",\n            \"pragma\": \"no-cache\",\n            \"referer\": \"https://www.hull.gov.uk/bins-and-recycling/bin-collections/bin-collection-day-checker\",\n            \"sec-fetch-dest\": \"empty\",\n            \"sec-fetch-mode\": \"cors\",\n            \"sec-fetch-site\": \"same-origin\",\n            \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.186 Safari/537.36\",\n        }\n        api_url = f\"https://www.hull.gov.uk/ajax/bin-collection?bindate={user_uprn}\"\n    \n        res = requests.get(api_url, headers=headers)\n        if res.status_code != 200:\n>           raise ConnectionRefusedError(\"Cannot connect to API!\")\nE           ConnectionRefusedError: Cannot connect to API!\n\nuk_bin_collection/uk_bin_collection/councils/HullCityCouncil.py:36: ConnectionRefusedError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"failed","statusMessage":"ConnectionRefusedError: Cannot connect to API!","statusTrace":"fixturefunc = <function scrape_step at 0x7fefb8b58cc0>\nrequest = <FixtureRequest for <Function test_scenario_outline[HullCityCouncil-None-None]>>\nkwargs = {'context': <test_validate_council.context.<locals>.Context object at 0x7fefb81fc8d0>, 'council': 'HullCityCouncil', 'headless_mode': 'True', 'selenium_mode': 'None', ...}\n\n    def call_fixture_func(\n        fixturefunc: \"_FixtureFunc[FixtureValue]\", request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n../../../.cache/pypoetry/virtualenvs/uk-bin-collection-EwS6Gn8s-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:902: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nuk_bin_collection/tests/step_defs/test_validate_council.py:92: in scrape_step\n    context.parse_result = CollectData.run()\nuk_bin_collection/uk_bin_collection/collect_data.py:102: in run\n    return self.client_code(\nuk_bin_collection/uk_bin_collection/collect_data.py:121: in client_code\n    return get_bin_data_class.template_method(address_url, **kwargs)\nuk_bin_collection/uk_bin_collection/get_bin_data.py:80: in template_method\n    bin_data_dict = self.parse_data(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <HullCityCouncil.CouncilClass object at 0x7fefb7f71e50>, page = ''\nkwargs = {'headless': True, 'paon': None, 'postcode': None, 'uprn': '21033995', ...}\nuser_uprn = '21033995', data = {'bins': []}\nheaders = {'accept': '*/*', 'accept-language': 'en-GB,en;q=0.9', 'authority': 'www.hull.gov.uk', 'cache-control': 'no-cache', ...}\napi_url = 'https://www.hull.gov.uk/ajax/bin-collection?bindate=21033995'\nres = <Response [500]>\n\n    def parse_data(self, page: str, **kwargs) -> dict:\n    \n        user_uprn = kwargs.get(\"uprn\")\n        check_uprn(user_uprn)\n        data = {\"bins\": []}\n    \n        headers = {\n            \"authority\": \"www.hull.gov.uk\",\n            \"accept\": \"*/*\",\n            \"accept-language\": \"en-GB,en;q=0.9\",\n            \"cache-control\": \"no-cache\",\n            \"pragma\": \"no-cache\",\n            \"referer\": \"https://www.hull.gov.uk/bins-and-recycling/bin-collections/bin-collection-day-checker\",\n            \"sec-fetch-dest\": \"empty\",\n            \"sec-fetch-mode\": \"cors\",\n            \"sec-fetch-site\": \"same-origin\",\n            \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.186 Safari/537.36\",\n        }\n        api_url = f\"https://www.hull.gov.uk/ajax/bin-collection?bindate={user_uprn}\"\n    \n        res = requests.get(api_url, headers=headers)\n        if res.status_code != 200:\n>           raise ConnectionRefusedError(\"Cannot connect to API!\")\nE           ConnectionRefusedError: Cannot connect to API!\n\nuk_bin_collection/uk_bin_collection/councils/HullCityCouncil.py:36: ConnectionRefusedError","steps":[{"name":"Given the council: HullCityCouncil","time":{"start":1715732906012,"stop":1715732906013,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"When we scrape the data from HullCityCouncil using None and the None is set","time":{"start":1715732906013,"stop":1715732911794,"duration":5781},"status":"failed","statusMessage":"Cannot connect to API!","statusTrace":"ConnectionRefusedError: Cannot connect to API!\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"host","value":"fv-az1242-422"},{"name":"thread","value":"2673-MainThread"},{"name":"framework","value":"pytest-bdd"},{"name":"language","value":"cpython3"},{"name":"feature","value":"Test each council output matches expected results"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"council","value":"HullCityCouncil"},{"name":"selenium_mode","value":"None"},{"name":"selenium_url","value":"None"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":4,"broken":0,"skipped":0,"passed":57,"unknown":0,"total":61},"items":[{"uid":"fa9b0b52a6d854c0","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1776//#testresult/fa9b0b52a6d854c0","status":"passed","time":{"start":1715720047669,"stop":1715720049147,"duration":1478}},{"uid":"c048cac0c711e82f","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1766//#testresult/c048cac0c711e82f","status":"passed","time":{"start":1715646517746,"stop":1715646519165,"duration":1419}},{"uid":"dd5b34b7a4fe0eda","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1765//#testresult/dd5b34b7a4fe0eda","status":"passed","time":{"start":1715560183729,"stop":1715560185256,"duration":1527}},{"uid":"340eb49b2e31948b","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1764//#testresult/340eb49b2e31948b","status":"passed","time":{"start":1715473849133,"stop":1715473850865,"duration":1732}},{"uid":"d73064aa3be1e6c6","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1763//#testresult/d73064aa3be1e6c6","status":"passed","time":{"start":1715387289801,"stop":1715387291566,"duration":1765}},{"uid":"709f87904b0c54ba","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1762//#testresult/709f87904b0c54ba","status":"passed","time":{"start":1715300887000,"stop":1715300888576,"duration":1576}},{"uid":"169bec50c2112ea5","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1760//#testresult/169bec50c2112ea5","status":"passed","time":{"start":1715285170593,"stop":1715285172496,"duration":1903}},{"uid":"b8b5f08a37ed6d76","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1756//#testresult/b8b5f08a37ed6d76","status":"passed","time":{"start":1715214785584,"stop":1715214786996,"duration":1412}},{"uid":"ec17367ee10fe6d9","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1743//#testresult/ec17367ee10fe6d9","status":"passed","time":{"start":1715041672868,"stop":1715041674454,"duration":1586}},{"uid":"5efe1c1c3c7e999c","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1742//#testresult/5efe1c1c3c7e999c","status":"passed","time":{"start":1714955327491,"stop":1714955329122,"duration":1631}},{"uid":"fb8d154538a09f9","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1741//#testresult/fb8d154538a09f9","status":"passed","time":{"start":1714869000173,"stop":1714869001497,"duration":1324}},{"uid":"d6833493d4e5f05a","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1740//#testresult/d6833493d4e5f05a","status":"passed","time":{"start":1714782438735,"stop":1714782440478,"duration":1743}},{"uid":"223492de99320e09","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1739//#testresult/223492de99320e09","status":"passed","time":{"start":1714696067724,"stop":1714696069322,"duration":1598}},{"uid":"7b78bf5c9b0c207f","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1738//#testresult/7b78bf5c9b0c207f","status":"passed","time":{"start":1714609653357,"stop":1714609655005,"duration":1648}},{"uid":"7c8ff9acbb2f6603","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1735//#testresult/7c8ff9acbb2f6603","status":"passed","time":{"start":1714523378956,"stop":1714523380115,"duration":1159}},{"uid":"cd93f271a4630f4b","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1734//#testresult/cd93f271a4630f4b","status":"passed","time":{"start":1714436805741,"stop":1714436807574,"duration":1833}},{"uid":"3b32831518c2e897","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1732//#testresult/3b32831518c2e897","status":"passed","time":{"start":1714350543198,"stop":1714350544867,"duration":1669}},{"uid":"e2e0e47d26389e19","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1724//#testresult/e2e0e47d26389e19","status":"passed","time":{"start":1714264245789,"stop":1714264247308,"duration":1519}},{"uid":"ded0d3dea49119ff","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1722//#testresult/ded0d3dea49119ff","status":"passed","time":{"start":1714234222840,"stop":1714234223876,"duration":1036}},{"uid":"255860bdf4a2e43a","reportUrl":"https://robbrad.github.io/UKBinCollectionData/3.11/1714//#testresult/255860bdf4a2e43a","status":"passed","time":{"start":1714232761264,"stop":1714232762734,"duration":1470}}]},"tags":[]},"source":"91962c5d4967cd8c.json","parameterValues":["HullCityCouncil","None","None"]}